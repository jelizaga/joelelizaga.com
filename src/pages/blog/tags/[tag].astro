---
// [tag].astro /////////////////////////////////////////////////////////////////
// Dynamically creates routes @ /blog/tags/`tag` for every blog post tag.

import Layout from "../../../layouts/Layout.astro";
import BlogPostCard from "../../../components/BlogPostCard.astro";
import Pagination from "../../../components/Pagination.astro";

export async function getStaticPaths() {
  const blogPosts = await Astro.glob("../../../blog/*.mdx");
  return [
    { params: { tag: "UX" }, props: { blogPosts: blogPosts } },
    { params: { tag: "Web Development" }, props: { blogPosts: blogPosts } },
  ];
}

const { tag } = Astro.params;
const { blogPosts } = Astro.props;
const tagSpecificPosts = blogPosts.filter((blogPost) => 
  blogPost.frontmatter.tags.includes(tag)
);
const title = `Joel Elizaga | Blog | ${tag}`;
---

<Layout title={title}>
  <main>
    <h1><i class="fa-solid fa-atlas"></i> Blog: {tag}</h1>
    <ul class="blog">
      {tagSpecificPosts.map(blogPost => (
        <BlogPostCard
          slug={`blog/${blogPost.frontmatter.slug}`}
          title={blogPost.frontmatter.title}
          description={blogPost.frontmatter.description}
          img={blogPost.frontmatter.img}
          date={blogPost.frontmatter.date}
          tags={blogPost.frontmatter.tags}
        />
      ))}
    </ul>
  </main>
</Layout>

<style>
  .blog {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    list-style: none;
    margin: 0;
    padding: 0;
  }

  main {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }
</style>